define(function(require, exports, module) {

    var $ = require('jquery'),
        _ = require('underscore'),
        Backbone = require('backbone'),
        jQueryUI = require('jqueryui'),
        parsley = require('parsley'),
        LoginView = require('views/login');

    module.exports = Backbone.View.extend({
        el: '#calendar',

        template: require('tpl!templates/login.ejs'),

        events: {
            'click #login-btn': 'doLogin',
            'keyup #login-password-input': 'onPasswordKeyup'
        },

        initialize: function(options) {
            
            console.log("Login View");
            this.render();
        },

        render: function() {
            this.$el.html(this.template(this));
            return this;
        },

        // Allow enter press to trigger login
        onPasswordKeyup: function(evt){
            var k = evt.keyCode || evt.which;

            if (k == 13 && $('#login-password-input').val() === ''){
                evt.preventDefault();    // prevent enter-press submit when input is empty
            } else if(k == 13){
                evt.preventDefault();
                this.doLogin();
                return false;
            }
        },

        doLogin: function(evt) {
            evt.preventDefault();
             if(this.$("#login-form").parsley('validate')){
                alert("inn");
                Backbone.history.navigate('', true);
            } else {
                alert("out");
            }
        }
    });
});